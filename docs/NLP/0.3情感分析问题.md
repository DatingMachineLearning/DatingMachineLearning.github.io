# 情感分析问题

文本情感分析又称意见挖掘，简单而言，是对带有情感色彩的主观性文本进行分析、处理、归纳和推理的过程。

最初的情感分析源自前人对带有情感色彩的词语的分析[1]，如，“美好”是带有褒义色彩的词语，而“丑陋”是带有贬义色彩的词语。随着互联网上大量的带有情感色彩的主观性文本的出现，研究者们逐渐从简单的情感词语的分析研究过渡到更为复杂的情感句研究以及情感篇章的研究。基于此，按照处理文本的粒度不同，情感分析可分为词语级、短语级、句子级、篇章级以及多篇章级等几个研究层次[2]。

按照处理文本的类别不同，可分为基于新闻评论的情感分析和基于产品评论的情感分析。其中，前者处理的文本主要是新闻评论，如情感句“他坚定地认为台湾是中国不可分割的一部分”，表明了观点持有者“他”对于事件“台湾归属问题”的立场;后者处理的主要是网络在线的产品评论文本，如“Polo的外观很时尚”，表明了对评价对象“Polo的外观”的评价“时尚”是褒义的。由于基于产品评论的情感分析可以帮助用户了解某一产品在大众心目中的口碑，因此受到很多消费者和商业网站的青睐。而基于新闻评论的情感分析多用于舆情监控和信息预测中，是国内外评测中重要的评测任务。

Sentiment analysis 说白了就是来分析人们对一个事物的**态度(attitudes)**，包含下面**几个元素**(以 Mary likes the movie 为例)

- Holder (source) of attitude
  - 观点（态度）持有者: Mary
  - 观点的情感是某个观点表达的感受、态度、评价或者情绪。它可以表示为三元组(y, o, i)，其中
    - y是情感类型(type)
    - o是情感的极性
    - i是情感的强度
- Target (aspect) of attitude
  - 评价对象: the movie
- Type of attitude 
  - 态度类型: like

实体和aspect，也就是把子部件和属性都称为aspect。对于观点的情感(sentiment)，不管是正面的、负面的和中立的还是1星到5星，我们都可以用一个数值来表示，比如-1表示负面的而0表示中立的而1表示正面的。

- e代表实体(entity)
- a代表aspect，可以是实体的属性，也可以是子部件或者子部件的属性
- s表示一个数值，表示不同的情感
- h是观点的持有者
- t是时间

**情感分析的具体任务**

- 实体抽取(entity extraction)和指代消解(resolution)
  - 识别五元组中的实体。这和NLP的命名实体识别(NER)有一点关系，比如产品名称等通常就是命名实体。但是观点里的实体并不都是命名实体，比如”I hate tax increase”这个观点的实体是抽象的概念”tax increase”，这不是命名实体。
  - 识别出实体之后，我们还需要”归一化”。我们需要定义一个实体类别(entity category)，比如iphone_5(它只是一个ID)，而它的不同文字描述比如”iPhone5”，”iphone 5”和”苹果5”都是对应这个实体类别。这些不同的文字叫做实体表示(entity expression)或者entity mention(不知道咋翻译好)。
  - 识别文档d里的所有entity expression，然后根据指代是否同一个实体把它们分组起来(或者叫归一化成一个ID)。
- aspect抽取和指代消解
  - aspect也是一样，比如camera的”picture”, “image”和”photo”指得都是同一个aspect。因此我们也有aspect category和aspect expression。
  - 和实体类似，只不过处理aspect
  - 显式的aspect expression是文本里的名词或者名词短语。比如”The picture quality of this camera is great”中，picture quality这个aspect expression是名词短语。
  - 隐式的aspect expression通常通过形容词来隐含的表示。比如”This camera is expensive”，对应的aspect是price，这是通过形容词expensive来推断出来的。除了形容词，动词也可以隐含aspect，比如”I can install the software easily”，通过动词install可以推断出aspect是installation。
- 观点持有者的抽取和指代消解
  - 抽取观点的持有者并进行指代消解
- 时间抽取和归一化
- aspect的情感分类/回归
  - 判断某个aspect的情感分类或者预测连续的情感强度
- 生成所有的观点五元组
- 抽取观点的原因
- 抽取观点的限定词

## 情感信息抽取

情感信息抽取旨在抽取情感文本中有价值的情感信息，它可以看作情感分析的基础任务。

纵观目前的研究现状，有价值的情感信息单元主要有

- 评价词语(如优秀、好用)
- 评价对象(屏幕分辨率)
- 观点持有者(如国家政府、台湾当局)

在对大量的情感文本进行分析之后，不少研究者发现，某些组合搭配对于情感分析的上层任务如情感信息分类以及情感信息的检索与归纳有更直接的帮助，如

- 评价搭配(评价对象和评价词语的搭配，如屏幕分辨率-高)、
- 评价短语(程度副词及其修饰的评价词语的搭配，如不怎么-好)等。

下面本文将一一介绍目前情感信息抽取的具体任务及其主要实现技术。

### 评价词语的抽取和判别

评价词语在情感文本中处于举足轻重的地位，评价词语的识别和极性判断在情感分析领域创建伊始就引起了人们极大的兴致。基于前人大量的研究工作，评价词语的抽取和判别往往是一个一体化的工作，主要分为基于语料库和基于词典两种方法。

#### 基于语料库的评价词语抽取和判别

主要是利用大语料库的统计特性，观察一些现象来挖掘语料库中的评价词语并判断极性。

- 早期的一些学者发现，由连词(如and或but)连接的两个形容词的极性往往存在一定的关联性，如and连接的形容词(如lovely and beautiful)极性相同，然而but连接的形容词(如lovely but unnatural)极性相反。基于这种现象，Hatzivassiloglou 和 McKeown[1]从大语料库华尔街日报(Wall Street Journal)中发掘出大量的形容词性的评价词语。

- Wiebe等人[7]沿袭了较为相似的工作，他们使用了一种相似度分布的词聚类方法在大语料库上完成了形容词性的评价词语的获取。然而，以上的两种方法仅将评价词语的词性局限于形容词词性，却忽略了其他词性的评价词语。为了避免评价词语词性的限制，Riloff等人[8]手工制定一些模板并选取种子评价词语，使用迭代的方法获取了名词词性的评价词语。

- Turney和Littman[9]提出了点互信息(point   mutual   information)的方法判别某个词语是否是评价词语。这种方法适用于各种词性的评价词语的识别，但是较为依赖种子褒/贬词语集合。

基于语料库的方法：

- 最大的优点在于**简单易行**
- 缺点则在于**可利用的评论语料库有限**，同时评价词语在大语料库中的分布等现象并不容易归纳。

#### 基于词典的评价词语抽取及判别方法

主要是使用词典中的词语之间的词义联系来挖掘评价词语。 这里的词典一般是指使用 WordNet 或HowNet等。

- 利用词典将手工采集的种子评价词语进行扩展来获取大量的评价词语[10−12].
  - 这种方法简单易行，但是较依赖于种子评价词语的个数和质量，并且容易由于一些词语的多义性而引入噪声。为了避免词语的多义性，一部分学者使用词典中词语的注释信息来完成评价词语的识别与极性判断[13−16].
- Turney等人的点互信息的方法[9],通过计算 WordNet 中的所有形容词与种子褒义词代表good和贬义词bad之间的关联度值来识别出评价词语。
  - 并非所有语种的情感资源都像英文一样丰富，对于某些词典资源非常稀缺的语种，有学者将词典资源丰富的语种的情感词典翻译到资源较少的语种中[18],如将英文的情感词典翻译成中文，供中文情感分析应用。但是实验显示，不少评价词语在经过翻译之后极性发生了改变。这也印证了Wiebe在文献[19]中所指出的“词语的词义和其极性有一定的关系，但是相同的词义并不一定有相同的极性”.鉴于此，基于词典的方法的优点在于获取的评价词语的规模非常可观，但是由于很多词存在一词多义现象，构建的情感词典往往含有较多的歧义词，如词语“好”在大多数情况下表现为“优秀”的意思，但在某些情况下扮演修饰成分(如“他跑得好快啊!”). 

- 采用基于图的方法来识别评价词语的极性[6,20].具体来说，该方法将要分类的词语作为图上的点，利用词语之间的联系形成边来构建图，继而采用各种基于图的迭代算法(propagation  algorithm)来完成词语的分类。如，有学者考察图中两个词语的注释信息而构建图[20],继而使用Spin模型对图中的点迭代地进行概率计算，得出每个词语的极性。
- 还有一些学者尝试使用多种图模型[6],如最小切分模型(mincuts)、随机最小切分模型(randomized  mincuts)、标签迭代模型(label  propagation)等完成评价词语的褒贬分类。
  - 实验证实了基于图的方法的有效性。基于图的方法是一种新颖的方法，它可以灵活地将词语间的各种联系作为特征融入图中，继而进行迭代计算。然而，寻找更为有效的词语间特征以及如何选取图算法是值得深入研究的问题。

### 评价对象的抽取

评价对象是指某段评论中所讨论的主题，具体表现为评论文本中评价词语所修饰的对象，如新闻评论中的某个事件/话题或者产品评论中某种产品的属性(如“屏幕”)等。现有的研究大部分集中于产品领域的评价对象的抽取，他们大多将评价对象限定在名词或名词短语(候选评价对象)的范畴内，进而对它们进行进一步的识别。

- 基于规则/模板的方法抽取评价对象
  - 规则的制定通常要基于一系列的语言分析与预处理过程，如词性标注、命名实体识别、句法分析等。相应地，制定的规则也包括词序列规则、词性规则以及句法规则等形式。Yi[21]使用3条限制等级逐渐递进的词性规则从候选评价对象中抽取出真正的评价对象。还有的学者[22,23]使用关联规则挖掘的方法或是基于句法分析的结果[24]找出频繁出现的候选评价对象，继而使用两种剪枝方法去除错误样例。然而，这些方法仅能找出频繁的评价对象。为了发掘出非频繁的评价对象，有学者尝试使用含有评价词语和评价对象槽(slot)的词序列模板[22].此类方法最主要的优点在于针对性强，可以直接针对待解决的问题或特定的语言现象制定规则/模板;而其缺点则在于规则/模板的可扩展性差，人工编写的工作量大，成本较高。
- 将评价对象看作产品属性的一种表现形式
  - (如对数码相机领域而言，“相机的大小”是数码相机的一个属性，而“相机滑盖”是数码相机的一个组成部分),继而考察候选评价对象与领域指示词(如“整体-部分”关系指示词“scanner  has”)之间的关联度来获取真正的评价对象。实验结果表明，这种方法取得了较好的实验效果，超过了基于规则/模板的方法，但难点在于领域指示词的获取。
- 话题模型(topic  model)
  - 很多学者将其应用到情感分析领域。由于评价对象是蕴涵于情感文本中的某些话题，因此可以使用话题模型来评价对象的识别。有学者[28]采用多粒度的话题模型挖掘产品领域情感文本中的评价对象，并将相似的评价对象进行聚类。这种方法理论上能够提高评价对象抽取的召回率。但遗憾的是，还没有实验将这种方法与上述传统的基于名词短语的方法进行对比。

### 观点持有者抽取

观点持有者的抽取在基于新闻评论的情感分析中显得尤为重要，它是观点/评论的隶属者，如新闻评论句“我国政府坚定不移的认为台湾是中国领土不可分割的一部分”中的“我国政府”.很自然地，人们会想到评论中的观点持有者一般是由命名实体(如人名或机构名)组成，因此可以借助于命名实体识别技术来获取观点持有者[31].此外，还有学者曾尝试借助语义角色标注来完成观点持有者的抽取[29].但是这些方法较为依赖自然语言处理的基础技术，有较低的语言覆盖现象和较差的领域适应性。

- 定义为分类任务
  - 这种方法的关键在于分类器和特征的选取。如Choi将其看作一个序列标注问题[32],并使用CRF(conditional  random  field)模型融合各种特征来完成观点持有者的抽取。
  - 相似地，Kim[11]将所有名词短语都视为候选观点持有者，使用ME(maximum entropy)模型来进行计算
- 观点持有者一般是与观点同时出现的，之前方法将观点持有者的抽取当作一个独立的任务
  - 所以可以将观点和观点持有者的识别作为一个任务同时解决。Bethard[33]在抽取出情感句中的观点单元(多是由一些短语组成)之后，分析句中观点和动词的句法关系，即可同步获取观点持有者。 

### 组合评价单元的抽取

评价词语在情感分析中的作用是不言而喻的。然而在某些情况下，单独的评价词语存在一定的歧义性，如评价词语“高”在以下3个句子中的使用：

- Sen 1:凯越的油耗真高。
- Sen 2:捷达的性价比相当高。 
- Sen 3:这辆车有1米多高。 

Sen  1和Sen  2是情感句，但是评价词语“高”在修饰不同的评价对象时表现出不同的极性。如，“高”在Sen  1中表示贬义，而在Sen  2中则表示褒义。此外，评价词语往往也会出现在非情感句中，如Sen  3.因此，仅考虑单独的评价词语在情感分析中的应用是远远不够的。研究者们发现，有些包含评价词语的“组合评价单元”(如组合“油耗-高”、“相当-高”)对于处理情感分析的上层任务更有帮助。下面将具体来介绍各种形式的组合评价单元。 

#### 主观表达式的抽取

**主观表达式(subjective clues)是指表示情感文本单元主观性的词语或词组**. 评价词语是主观表达式的一部分。此外，某些词语的组合(如village idiot 或get out of here)也能很明显地标识文本的主观性，虽然它们中的任何一个词语单独可能都并非评价词语。如何获取这些有意义的词组是主观表达式抽取的重点。

- Wiebe 和 Wilson 是这项任务的引领者[34].近几年来，他们挖掘大量的主观表达式形成主观表达式库，并基于此完成文本的主客观分类和褒贬分类，首先从语料中抽取出所有的n 元词语/词组(1≤n≤4)作为候选主观表达式;继而通过对比训练语料中的标准的主观表达式，为每个候选主观表达式计算出可能成为主观表达式的概率;最后通过对概率值的分析，获得这些主观表达式。

- Wiebe 和 Wilson[35]在随后的工作中又引入了“**主观表达式密度**”协助判断主观表达式。2004 年，Wiebe 和Wilson 将他们前期的工作进行了总结[36],从不同的语料中扩充了大量的主观表达式，主要包括手工收集的一部分主观表达式以及自动从标注/未标注语料中学习而来的一部分主观表达式。此外，他们首次利用句法分析的结果发掘了句法主观表达式[37].
- 随后，Wiebe 和Wilson 采用多种特征及机器学习方法对他们获取的大量的主观表达式的情感程度(strong 或weak)进行了识别

####  评价短语的抽取

**评价短语表现为一组连续出现的词组**,但不同于主观表达式，该词组往往是由程度副词和评价词语组合而成，如“very  good”等。因此，这种组合评价单元不仅顾及了主观表达式的情感极性，还考察了其修饰成分。这些修饰成分或加强或减弱或置反了主观表达式的情感极性，使得评价短语成为一种情感色彩丰富的组合评价单元。

- 基于一些情感词典的方法识别这种评价短语。如 Whitelaw[38]结合 WordNet 使用半自动的方法构建了形容词性的评价词词典以及修饰词词典。对于一个含有评价词语的情感文本，该方法首先查看评价词前面的词语，如果属于修饰词词典，获取这个词组作为评价短语。根据两个词典中的属性值计算出情感极性。这种方法由于基于较为细致的词典，因此准确率较高
  - 然而，由于词典中词语有限而限制了召回率
- 使用依存句法结构(如 ADV,ATT 以及 DE 结构),在句法树上获取评价短语[23].这种方法巧妙地利用了评价短语中所含词语之间的句法修饰关系，但是较为依赖句法分析的结果。 

**评价短语考察的是连续出现的词组，然而有些表示修饰关系的词语并非总是和评价词语连续出现**.

如在情感句  $[I\  did\  [not]^−\  have\  any\  [doubt]^−\  about\  it.\ ]^+$ 中，修饰词 not 和评价词 doubt 并非连续出现，但它们共同决定了情感句的最终极性。Moilanen 等人[39]和Choi 等人[40]将其定义为“组合语义单元(compositional  semantics)”,具体表现为一组非连续的词语，通过相互作用来表达出某种情感极性。组合语义单元可以看作一种更为复杂的评价短语，大多使用人工总结或半自动生成的模板来识别。

#### 评价搭配的抽取

**评价搭配是指评价词语及其所修饰的评价对象二者的搭配，表现为二元对〈评价对象，评价词语〉**,如情感句“凯越的油耗很高”中的“油耗-高”.前面所介绍的“主观表达式”和“评价短语”主要是考察含有情感极性的一些词和短语，然而情感句中出现的某些“主观表达式”和“评价短语”并非真正地表现出情感极性。如情感句 s1“车跑得好快啊”中的词语“好”并不存在情感极性，需要过滤掉。此外，还有一些“主观表达式”和“评价短语”存在一定的歧义，其极性需要根据上下文而确定。“评价搭配”则可以很好地解决上述两点问题。 

- 大部分学者采用了基于模板的获取方法
  - Kobayashi 等人[41]考察评价对象和评价词语之间的修饰关系，并用8 个共现模板来描述。然而，由于模板过于简单且修饰关系仅仅停留在词表面，该方法产生了大量的噪声。为了深入挖掘评价对象和评价词语之间的修饰关系，一部分学者尝试使用句法关系模板。 Bloom 等人[42]利用Stanford Parser 手工构建了31 条句法规则。
  - Popescu 等人[25]利用 MINIPAR Parser 手工构建了10 条依存句法抽取模板来获取评价搭配。
  - 姚天昉等人[43]基于依存句法分析总结出“上行路径”和“下行路径”的匹配规则;后续总结出 SBV(subjective-verb)极性传递规则，用于评价搭配的识别。可以看出，他们的工作融入了更多对评价对象和评价词语之间深层关系的挖掘。
  - 由于匹配规则或模板的制定存在**过多的人工参与**,覆盖率较低。因此在未来的工作中，我们应该侧重于研究自动生成评价对象和评价词语之间的匹配规则的策略。 

## 情感信息分类

情感信息的分类任务可大致分为两种:一种是主、客观信息的二元分类;另一种是主观信息的情感分类，包括最常见的褒贬二元分类以及更细致的多元分类

### 主客观信息分类

在对情感文本进行情感分析时，往往由于情感文本中夹杂着少量的客观信息而影响了情感分析的质量[45],因此将情感文本中的主观信息和客观信息进行分离变得非常必要。由于情感文本单元表现格式比较自由，且区分主、客观文本单元的特征并不明显，在很多情况下，情感文本的主客观识别比主观文本的情感分类更有难度。

……

### 主观信息情感分类

**主观信息情感任务按不同的文本粒度可分为词语级、短语级、句子级和篇章级等**.其中，第 1 节已经对词语级和短语级的情感分类方法进行了总结，因此本节将着重介绍句子级和篇章级的主观信息情感分类方法。 

一般而言，研究者将主观本文的极性分为褒义和贬义两类(thumbs  up?  thumbs  down?).纵观目前的研究工作，与主客观信息分类类似，可分为两种研究思路:基于情感知识的方法以及基于特征分类的方法

- 基于情感知识：依靠一些已有的情感词典或领域词典以及主观文本中带有情感极性的组合评价单元进行计算，来获取主观文本的极性
  - 分析句子/篇章中的评价词语或组合评价单元的极性，然后进行极性加权求和。这种方法的重点一般都放在评价词语或组合评价单元的抽取和极性判断方法的研究上。
- 基于特征分类：主要是使用机器学习的方法，选取大量有意义的特征来完成分类任务。
  - Pang[52]首次将机器学习的方法应用于篇章级的情感分类任务中。他们尝试使用了n-gram 词语特征和词性特征，并对比了NB,ME 和SVM(support vector machine)这3 种分类模型，发现 unigram 特征效果最好。
  - Cui[53]通过实验证明，当训练语料较少时，unigram 的效果较优;但随着训练语料的增多，n-gram  (n>3)发挥了越来越重要的作用
  - Kim[54]除了考察传统的 n-gram 模型之外，还引入了位置特征和评价词特征来完成句子级的褒贬分类
  - Zhao[55]则将句子级情感分类任务提炼为一个三层分类任务，利用各层之间类别标签的相互作用，并考虑上下句之间情感的互相影响，使用CRF 模型将这些特征进行融合

### 观点分类与挖掘

情感分类还可以体现在对某些事件的观点分类上。Lin 等人[58]主要使用 3 种分类模型识别有关“巴以冲突”主题的评论文本所表达的观点，即是“支持巴方”还是“支持以方”.而 Kim 等人[59]主要对美国大选时涌现出来的大量评论文章进行分类汇总，从而推断大部分选民是支持“共和党”还是“民主党”.该文献同样也是使用分类器和分类特征相结合的算法，其中对分类特征进行了泛化，取得了较好的效果。和主观信息情感分类不同的是，“观点分类与挖掘”任务除了需要使用情感知识之外，还需要发掘一部分与“观点”相关的知识。

## 参考

> [lihang-code/11.CRF.ipynb at master · fengdu78/lihang-code](https://github.com/fengdu78/lihang-code/blob/master/%E7%AC%AC11%E7%AB%A0%20%E6%9D%A1%E4%BB%B6%E9%9A%8F%E6%9C%BA%E5%9C%BA/11.CRF.ipynb)
>
> [typoverflow/pytorch-crf: 条件随机场（CRF）的pytorch实现](https://github.com/typoverflow/pytorch-crf)
>
> [斯坦福大学自然语言处理第七课“情感分析（Sentiment Analysis）” - 我爱公开课](http://52opencourse.com/235/%E6%96%AF%E5%9D%A6%E7%A6%8F%E5%A4%A7%E5%AD%A6%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E7%AC%AC%E4%B8%83%E8%AF%BE-%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90%EF%BC%88sentiment-analysis%EF%BC%89)
>
> [情感分析简介 - 李理的博客](http://fancyerii.github.io/2019/09/25/sentiment-analysis-survey/#%E6%9C%AF%E8%AF%AD%E8%A7%A3%E9%87%8A)
>
> [Sentiment Analysis情感分析——珍藏版](https://mp.weixin.qq.com/s/5VrZTMlNxbgZmaeOxBps_w)
